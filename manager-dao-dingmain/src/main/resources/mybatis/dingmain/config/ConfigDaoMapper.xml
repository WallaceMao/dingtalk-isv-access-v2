<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rishiqing.dingtalk.mgr.dingmain.dao.mapper.config.ConfigDao">
    <resultMap id="configMap" type="com.rishiqing.dingtalk.api.model.domain.config.ConfigDO">
        <id property="id" column="id"></id>
        <result property="gmtCreate" column="gmt_create"></result>
        <result property="gmtModified" column="gmt_modified"></result>
        <result property="configKey" column="config_key"></result>
        <result property="autoFilter" column="auto_filter"></result>
        <result property="autoFilterThreshold" column="auto_filter_threshold"></result>
    </resultMap>
    <select id="getConfigByConfigKey" resultMap="configMap">
        SELECT
            `id`,
            `gmt_create`,
            `gmt_modified`,
            `config_key`,
            `auto_filter`,
            `auto_filter_threshold` 
        FROM
            isv_config
        WHERE
            `config_key`=#{configKey}
    </select>
    <insert id="saveOrUpdateConfig">
        INSERT INTO `isv_config` (
            `gmt_create`,
            `gmt_modified`,
            `config_key`,
            `auto_filter`,
            `auto_filter_threshold`
        )
        VALUES
            (
            NOW(),
            NOW(),
            #{configKey},
            #{autoFilter},
            #{autoFilterThreshold}
            )
        ON DUPLICATE UPDATE gmt_modified=NOW(),
        `auto_filter`=VALUES(auto_filter),`auto_filter_threshold`=VALUES(auto_filter_threshold)
    </insert>
</mapper>